<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hot Works Permit</title>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;
  background:#f2f2f2;margin:0;padding:12px
}
h1,h2{text-align:center;margin:6px 0}
.section{
  background:#fff;padding:14px;margin-bottom:14px;border-radius:10px
}
label{display:block;font-weight:600;margin-top:10px}
input,textarea{
  width:100%;padding:10px;margin-top:6px;
  border:1px solid #ccc;border-radius:6px;font-size:16px
}
textarea{min-height:120px}
.checks label{font-weight:400}
canvas{
  width:100%;height:180px;border:2px dashed #777;
  border-radius:6px;touch-action:none
}
.sig-buttons{display:flex;gap:10px;margin-top:6px}
button{
  padding:12px;font-size:16px;border-radius:6px;border:none;
  background:#ddd;width:100%
}
.locked{pointer-events:none;opacity:.6}
@media print{
  button{display:none}
  body{background:#fff}
}
</style>
</head>

<body>

<h1>HOT WORKS PERMIT</h1>
<p style="text-align:center;font-size:14px">
Designed to align with AS 1674.1, AS 1940 and applicable Australian WHS Regulations
</p>

<div class="section">
  <label>Permit Number</label>
  <input>

  <label>PCBU / Company</label>
  <input>

  <label>Site / Location</label>
  <input>

  <label>Supervisor / Issuer</label>
  <input>

  <label>Date</label>
  <input id="date" type="date">

  <label>Start Time</label>
  <input id="start" type="time">

  <label>Finish Time</label>
  <input id="finish" type="time">
</div>

<div class="section">
  <label>Description of Works</label>
  <textarea placeholder="Detailed description of hot works, equipment, duration, and hazards"></textarea>
</div>

<div class="section checks">
  <h2>Type of Hot Work</h2>
  <label><input type="checkbox"> Welding</label>
  <label><input type="checkbox"> Grinding</label>
  <label><input type="checkbox"> Cutting</label>
  <label><input type="checkbox"> Brazing</label>
  <label><input type="checkbox"> Other</label>
</div>

<div class="section checks">
  <h2>Controls & Fire Prevention</h2>
  <label><input type="checkbox"> Combustible materials removed or protected</label>
  <label><input type="checkbox"> Floors, walls, penetrations sealed</label>
  <label><input type="checkbox"> Fire extinguishers available and suitable</label>
  <label><input type="checkbox"> Gas cylinders secured and tested</label>
  <label><input type="checkbox"> Ventilation adequate</label>
  <label><input type="checkbox"> Area inspected before works</label>
</div>

<div class="section checks">
  <h2>PPE</h2>
  <label><input type="checkbox"> Eye & face protection</label>
  <label><input type="checkbox"> Gloves</label>
  <label><input type="checkbox"> Protective clothing</label>
  <label><input type="checkbox"> Respiratory protection (if required)</label>
</div>

<div class="section">
  <h2>Fire Watch</h2>
  <label>Fire Watch Name</label>
  <input>

  <label>Fire Watch Signature</label>
  <canvas id="fireSig"></canvas>
  <div class="sig-buttons">
    <button onclick="fire.undo()">Undo</button>
    <button onclick="fire.clear()">Clear</button>
  </div>

  <label>Fire Watch Sign-off Time</label>
  <input id="fireTime" readonly>

  <p>Fire watch to remain for a minimum of 30 minutes after completion.</p>
</div>

<div class="section">
  <h2>Before / After Photos</h2>
  <label>Before Hot Works</label>
  <input type="file" accept="image/*" capture="environment">
  <label>After Completion</label>
  <input type="file" accept="image/*" capture="environment">
</div>

<div class="section">
  <h2>Final Authorisation</h2>
  <label>Authorising Person</label>
  <input>

  <label>Signature</label>
  <canvas id="authSig"></canvas>
  <div class="sig-buttons">
    <button onclick="auth.undo()">Undo</button>
    <button onclick="auth.clear()">Clear</button>
  </div>

  <label>Authorisation Time</label>
  <input id="authTime" readonly>
</div>

<div class="section">
  <button onclick="exportPDF()">Export / Save PDF</button>
</div>

<script>
function sigPad(id,time){
  const c=document.getElementById(id),x=c.getContext("2d");
  c.width=c.offsetWidth;c.height=c.offsetHeight;
  let s=[],cur=[],d=false;
  const p=e=>{const r=c.getBoundingClientRect();const t=e.touches?e.touches[0]:e;return{x:t.clientX-r.left,y:t.clientY-r.top}};
  const redraw=()=>{x.clearRect(0,0,c.width,c.height);x.lineWidth=2;x.lineCap="round";s.forEach(st=>{x.beginPath();st.forEach((p,i)=>i?x.lineTo(p.x,p.y):x.moveTo(p.x,p.y));x.stroke()})}
  const end=()=>{if(d&&cur.length){s.push(cur);document.getElementById(time).value=new Date().toLocaleString();lockCheck()}d=false}
  c.onmousedown=e=>{d=true;cur=[p(e)]}
  c.onmousemove=e=>{if(!d)return;cur.push(p(e));redraw();x.beginPath();cur.forEach((p,i)=>i?x.lineTo(p.x,p.y):x.moveTo(p.x,p.y));x.stroke()}
  c.onmouseup=end;c.onmouseleave=end;
  c.ontouchstart=e=>{d=true;cur=[p(e)]}
  c.ontouchmove=e=>{if(!d)return;cur.push(p(e));redraw();x.beginPath();cur.forEach((p,i)=>i?x.lineTo(p.x,p.y):x.moveTo(p.x,p.y));x.stroke()}
  c.ontouchend=end;
  return{undo(){s.pop();redraw()},clear(){s=[];redraw()}}
}

const fire=sigPad("fireSig","fireTime");
const auth=sigPad("authSig","authTime");

function lockCheck(){
  if(fireTime.value && authTime.value){
    document.querySelectorAll("input,textarea,canvas,button").forEach(e=>e.classList.add("locked"));
  }
}

function exportPDF(){window.print()}
date.value=new Date().toISOString().split("T")[0];
start.value=new Date().toTimeString().slice(0,5);
</script>

</body>
</html>